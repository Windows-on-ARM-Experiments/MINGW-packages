--- a/gettext-tools/gnulib-lib/localtime.c
+++ b/gettext-tools/gnulib-lib/localtime.c
@@ -63,11 +63,11 @@ rpl_localtime (const time_t *tp)
       char **env = _environ;
       wchar_t **wenv = _wenviron;
       if (env != NULL)
-        for (char *s = env; *s != NULL; s++)
+        for (char *s = *env; *s != NULL; s++)
           if (s[0] == 'T' && s[1] == 'Z' && s[2] == '=')
             s[0] = '$';
       if (wenv != NULL)
-        for (wchar_t *ws = wenv; *ws != NULL; ws++)
+        for (wchar_t *ws = *wenv; *ws != NULL; ws++)
           if (ws[0] == L'T' && ws[1] == L'Z' && ws[2] == L'=')
             ws[0] = L'$';
     }
--- a/gettext-tools/gnulib-lib/setenv.c
+++ b/gettext-tools/gnulib-lib/setenv.c
@@ -220,7 +220,7 @@
 
       new_environ[size + 1] = NULL;
 
-      last_environ = __environ = new_environ;
+      last_environ = new_environ;
     }
   else if (replace)
     {
@@ -311,13 +311,9 @@
   if (__environ == last_environ && __environ != NULL)
     {
       /* We allocated this environment so we can free it.  */
-      free (__environ);
       last_environ = NULL;
     }
 
-  /* Clear the environment pointer removes the whole environment.  */
-  __environ = NULL;
-
   UNLOCK;
 
   return 0;
